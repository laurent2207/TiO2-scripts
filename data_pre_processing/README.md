Created seperate repository for the pre-processing script. Please check if the script is okay and the way I have structered it. I could also split the script into 3 scripts easily.
